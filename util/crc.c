/*             ----> DO NOT REMOVE THE FOLLOWING NOTICE <----

                   Copyright (c) 2014-2015 Datalight, Inc.
                       All Rights Reserved Worldwide.

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; use version 2 of the License.

    This program is distributed in the hope that it will be useful,
    but "AS-IS," WITHOUT ANY WARRANTY; without even the implied warranty
    of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License along
    with this program; if not, write to the Free Software Foundation, Inc.,
    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
*/
/*  Businesses and individuals that for commercial or other reasons cannot
    comply with the terms of the GPLv2 license may obtain a commercial license
    before incorporating Reliance Edge into proprietary software for
    distribution in any form.  Visit http://www.datalight.com/reliance-edge for
    more information.
*/
/** @file
    @brief Implements utilities for calculating CRC-32 checksums.
*/
#include <redfs.h>


/*  The CRC functions do not return errors since the only detectable error
    condition is a NULL buffer pointer.  If such a condition does arise, the
    functions assert and return the below CRC, which, although a legal CRC,
    is nonetheless suspicious and could provide a clue that something has
    gone wrong.
*/
#define SUSPICIOUS_CRC_VALUE    (0xBAADC0DEU)

#define CRC_BITWISE     (0U)
#define CRC_SARWATE     (1U)
#define CRC_SLICEBY8    (2U)


#if REDCONF_CRC_ALGORITHM == CRC_BITWISE

/*  The following is representative of the polynomial accepted by CCITT 32-bit
    and in IEEE 802.3, Ethernet 2 specification.

    x^32+x^26+x^23+x^22+x^16+x^12+x^11+x^10+x^8+x^7+x^5+x^4+x^2+x+1
       (reverse order)
    1110 1101 1011 1000 1000 0011 0010 0000 1
     (E)  (D)  (B)  (8)  (8)  (3)  (2)  (0)
*/
#define CCITT_32_POLYNOMIAL             (0xEDB88320U)


/** @brief Compute a CRC32 for the given data buffer.

    For CCITT-32 compliance, the initial CRC must be set to 0.  To CRC multiple
    buffers, call this function with the previously returned CRC value.

    @param ulInitCrc32  Starting CRC value.
    @param pBuffer      Data buffer to calculate the CRC from.
    @param ulLength     Number of bytes of data in the given buffer.

    @return The updated CRC value.
*/
uint32_t RedCrc32Update(
    uint32_t        ulInitCrc32,
    const void     *pBuffer,
    uint32_t        ulLength)
{
    uint32_t        ulCrc32;

    if(pBuffer == NULL)
    {
        REDERROR();
        ulCrc32 = SUSPICIOUS_CRC_VALUE;
    }
    else
    {
        const uint8_t  *pbBuffer = CAST_VOID_PTR_TO_CONST_UINT8_PTR(pBuffer);
        uint32_t        ulIdx;

        ulCrc32 = ~ulInitCrc32;

        for(ulIdx = 0U; ulIdx < ulLength; ++ulIdx)
        {
            uint32_t ulBit;

            ulCrc32 ^= pbBuffer[ulIdx];

            /*  Branchless inner loop (greatly improves performance).
            */
            for(ulBit = 0U; ulBit < 8U; ulBit++)
            {
                ulCrc32 = ((ulCrc32 & 1U) * CCITT_32_POLYNOMIAL) ^ (ulCrc32 >> 1U);
            }
        }

        ulCrc32 = ~ulCrc32;
    }

    return ulCrc32;
}

#elif REDCONF_CRC_ALGORITHM == CRC_SARWATE

static const uint32_t gaulCrc32Table[] =
{
    0x00000000UL, 0x77073096UL, 0xEE0E612CUL, 0x990951BAUL,
    0x076DC419UL, 0x706AF48FUL, 0xE963A535UL, 0x9E6495A3UL,
    0x0EDB8832UL, 0x79DCB8A4UL, 0xE0D5E91EUL, 0x97D2D988UL,
    0x09B64C2BUL, 0x7EB17CBDUL, 0xE7B82D07UL, 0x90BF1D91UL,
    0x1DB71064UL, 0x6AB020F2UL, 0xF3B97148UL, 0x84BE41DEUL,
    0x1ADAD47DUL, 0x6DDDE4EBUL, 0xF4D4B551UL, 0x83D385C7UL,
    0x136C9856UL, 0x646BA8C0UL, 0xFD62F97AUL, 0x8A65C9ECUL,
    0x14015C4FUL, 0x63066CD9UL, 0xFA0F3D63UL, 0x8D080DF5UL,
    0x3B6E20C8UL, 0x4C69105EUL, 0xD56041E4UL, 0xA2677172UL,
    0x3C03E4D1UL, 0x4B04D447UL, 0xD20D85FDUL, 0xA50AB56BUL,
    0x35B5A8FAUL, 0x42B2986CUL, 0xDBBBC9D6UL, 0xACBCF940UL,
    0x32D86CE3UL, 0x45DF5C75UL, 0xDCD60DCFUL, 0xABD13D59UL,
    0x26D930ACUL, 0x51DE003AUL, 0xC8D75180UL, 0xBFD06116UL,
    0x21B4F4B5UL, 0x56B3C423UL, 0xCFBA9599UL, 0xB8BDA50FUL,
    0x2802B89EUL, 0x5F058808UL, 0xC60CD9B2UL, 0xB10BE924UL,
    0x2F6F7C87UL, 0x58684C11UL, 0xC1611DABUL, 0xB6662D3DUL,
    0x76DC4190UL, 0x01DB7106UL, 0x98D220BCUL, 0xEFD5102AUL,
    0x71B18589UL, 0x06B6B51FUL, 0x9FBFE4A5UL, 0xE8B8D433UL,
    0x7807C9A2UL, 0x0F00F934UL, 0x9609A88EUL, 0xE10E9818UL,
    0x7F6A0DBBUL, 0x086D3D2DUL, 0x91646C97UL, 0xE6635C01UL,
    0x6B6B51F4UL, 0x1C6C6162UL, 0x856530D8UL, 0xF262004EUL,
    0x6C0695EDUL, 0x1B01A57BUL, 0x8208F4C1UL, 0xF50FC457UL,
    0x65B0D9C6UL, 0x12B7E950UL, 0x8BBEB8EAUL, 0xFCB9887CUL,
    0x62DD1DDFUL, 0x15DA2D49UL, 0x8CD37CF3UL, 0xFBD44C65UL,
    0x4DB26158UL, 0x3AB551CEUL, 0xA3BC0074UL, 0xD4BB30E2UL,
    0x4ADFA541UL, 0x3DD895D7UL, 0xA4D1C46DUL, 0xD3D6F4FBUL,
    0x4369E96AUL, 0x346ED9FCUL, 0xAD678846UL, 0xDA60B8D0UL,
    0x44042D73UL, 0x33031DE5UL, 0xAA0A4C5FUL, 0xDD0D7CC9UL,
    0x5005713CUL, 0x270241AAUL, 0xBE0B1010UL, 0xC90C2086UL,
    0x5768B525UL, 0x206F85B3UL, 0xB966D409UL, 0xCE61E49FUL,
    0x5EDEF90EUL, 0x29D9C998UL, 0xB0D09822UL, 0xC7D7A8B4UL,
    0x59B33D17UL, 0x2EB40D81UL, 0xB7BD5C3BUL, 0xC0BA6CADUL,
    0xEDB88320UL, 0x9ABFB3B6UL, 0x03B6E20CUL, 0x74B1D29AUL,
    0xEAD54739UL, 0x9DD277AFUL, 0x04DB2615UL, 0x73DC1683UL,
    0xE3630B12UL, 0x94643B84UL, 0x0D6D6A3EUL, 0x7A6A5AA8UL,
    0xE40ECF0BUL, 0x9309FF9DUL, 0x0A00AE27UL, 0x7D079EB1UL,
    0xF00F9344UL, 0x8708A3D2UL, 0x1E01F268UL, 0x6906C2FEUL,
    0xF762575DUL, 0x806567CBUL, 0x196C3671UL, 0x6E6B06E7UL,
    0xFED41B76UL, 0x89D32BE0UL, 0x10DA7A5AUL, 0x67DD4ACCUL,
    0xF9B9DF6FUL, 0x8EBEEFF9UL, 0x17B7BE43UL, 0x60B08ED5UL,
    0xD6D6A3E8UL, 0xA1D1937EUL, 0x38D8C2C4UL, 0x4FDFF252UL,
    0xD1BB67F1UL, 0xA6BC5767UL, 0x3FB506DDUL, 0x48B2364BUL,
    0xD80D2BDAUL, 0xAF0A1B4CUL, 0x36034AF6UL, 0x41047A60UL,
    0xDF60EFC3UL, 0xA867DF55UL, 0x316E8EEFUL, 0x4669BE79UL,
    0xCB61B38CUL, 0xBC66831AUL, 0x256FD2A0UL, 0x5268E236UL,
    0xCC0C7795UL, 0xBB0B4703UL, 0x220216B9UL, 0x5505262FUL,
    0xC5BA3BBEUL, 0xB2BD0B28UL, 0x2BB45A92UL, 0x5CB36A04UL,
    0xC2D7FFA7UL, 0xB5D0CF31UL, 0x2CD99E8BUL, 0x5BDEAE1DUL,
    0x9B64C2B0UL, 0xEC63F226UL, 0x756AA39CUL, 0x026D930AUL,
    0x9C0906A9UL, 0xEB0E363FUL, 0x72076785UL, 0x05005713UL,
    0x95BF4A82UL, 0xE2B87A14UL, 0x7BB12BAEUL, 0x0CB61B38UL,
    0x92D28E9BUL, 0xE5D5BE0DUL, 0x7CDCEFB7UL, 0x0BDBDF21UL,
    0x86D3D2D4UL, 0xF1D4E242UL, 0x68DDB3F8UL, 0x1FDA836EUL,
    0x81BE16CDUL, 0xF6B9265BUL, 0x6FB077E1UL, 0x18B74777UL,
    0x88085AE6UL, 0xFF0F6A70UL, 0x66063BCAUL, 0x11010B5CUL,
    0x8F659EFFUL, 0xF862AE69UL, 0x616BFFD3UL, 0x166CCF45UL,
    0xA00AE278UL, 0xD70DD2EEUL, 0x4E048354UL, 0x3903B3C2UL,
    0xA7672661UL, 0xD06016F7UL, 0x4969474DUL, 0x3E6E77DBUL,
    0xAED16A4AUL, 0xD9D65ADCUL, 0x40DF0B66UL, 0x37D83BF0UL,
    0xA9BCAE53UL, 0xDEBB9EC5UL, 0x47B2CF7FUL, 0x30B5FFE9UL,
    0xBDBDF21CUL, 0xCABAC28AUL, 0x53B39330UL, 0x24B4A3A6UL,
    0xBAD03605UL, 0xCDD70693UL, 0x54DE5729UL, 0x23D967BFUL,
    0xB3667A2EUL, 0xC4614AB8UL, 0x5D681B02UL, 0x2A6F2B94UL,
    0xB40BBE37UL, 0xC30C8EA1UL, 0x5A05DF1BUL, 0x2D02EF8DUL,
};


/** @brief Compute a CRC32 for the given data buffer.

    For CCITT-32 compliance, the initial CRC must be set to 0.  To CRC multiple
    buffers, call this function with the previously returned CRC value.

    @param ulInitCrc32  Starting CRC value.
    @param pBuffer      Data buffer to calculate the CRC from.
    @param ulLength     Number of bytes of data in the given buffer.

    @return The updated CRC value.
*/
uint32_t RedCrc32Update(
    uint32_t        ulInitCrc32,
    const void     *pBuffer,
    uint32_t        ulLength)
{
    uint32_t        ulCrc32;

    if(pBuffer == NULL)
    {
        REDERROR();
        ulCrc32 = SUSPICIOUS_CRC_VALUE;
    }
    else
    {
        const uint8_t  *pbBuffer = CAST_VOID_PTR_TO_CONST_UINT8_PTR(pBuffer);
        uint32_t        ulIdx;

        ulCrc32 = ~ulInitCrc32;

        for(ulIdx = 0U; ulIdx < ulLength; ++ulIdx)
        {
            ulCrc32 = (ulCrc32 >> 8U) ^ gaulCrc32Table[(ulCrc32 ^ pbBuffer[ulIdx]) & 0xFFU];
        }

        ulCrc32 = ~ulCrc32;
    }

    return ulCrc32;
}

#elif REDCONF_CRC_ALGORITHM == CRC_SLICEBY8

/*  CRC32 XOR table, with slicing-by-8 extensions.

    This first column of the table contains the same XOR values as used in the
    classic byte-at-a-time Sarwate algorithm.  The other seven columns are
    derived from the first, and are used in Intel's slicing-by-eight CRC
    algorithm.

    The layout of this array in memory is novel and deserves explanation.  In
    other implementations, including Intel's example, each of the below columns
    is an array.  The first column is a 256-entry array, followed by another
    256-entry array for the second column, etc.  Testing on both ARM and x86
    has shown the below mixed arrangement to be about 5-9% faster.  One
    possible explanation: With the array-per-table approach, each of the eight
    table lookups is guaranteed to be in a separate 1 KB chunk of memory.  With
    the below array, sometimes multiple table lookups will, by coincidence, be
    close together, making better use of the cache.
*/
static const uint32_t gaulCrc32Table[] =
{
    0x00000000UL, 0x00000000UL, 0x00000000UL, 0x00000000UL, 0x00000000UL, 0x00000000UL, 0x00000000UL, 0x00000000UL,
    0x77073096UL, 0x191B3141UL, 0x01C26A37UL, 0xB8BC6765UL, 0x3D6029B0UL, 0xCB5CD3A5UL, 0xA6770BB4UL, 0xCCAA009EUL,
    0xEE0E612CUL, 0x32366282UL, 0x0384D46EUL, 0xAA09C88BUL, 0x7AC05360UL, 0x4DC8A10BUL, 0x979F1129UL, 0x4225077DUL,
    0x990951BAUL, 0x2B2D53C3UL, 0x0246BE59UL, 0x12B5AFEEUL, 0x47A07AD0UL, 0x869472AEUL, 0x31E81A9DUL, 0x8E8F07E3UL,
    0x076DC419UL, 0x646CC504UL, 0x0709A8DCUL, 0x8F629757UL, 0xF580A6C0UL, 0x9B914216UL, 0xF44F2413UL, 0x844A0EFAUL,
    0x706AF48FUL, 0x7D77F445UL, 0x06CBC2EBUL, 0x37DEF032UL, 0xC8E08F70UL, 0x50CD91B3UL, 0x52382FA7UL, 0x48E00E64UL,
    0xE963A535UL, 0x565AA786UL, 0x048D7CB2UL, 0x256B5FDCUL, 0x8F40F5A0UL, 0xD659E31DUL, 0x63D0353AUL, 0xC66F0987UL,
    0x9E6495A3UL, 0x4F4196C7UL, 0x054F1685UL, 0x9DD738B9UL, 0xB220DC10UL, 0x1D0530B8UL, 0xC5A73E8EUL, 0x0AC50919UL,
    0x0EDB8832UL, 0xC8D98A08UL, 0x0E1351B8UL, 0xC5B428EFUL, 0x30704BC1UL, 0xEC53826DUL, 0x33EF4E67UL, 0xD3E51BB5UL,
    0x79DCB8A4UL, 0xD1C2BB49UL, 0x0FD13B8FUL, 0x7D084F8AUL, 0x0D106271UL, 0x270F51C8UL, 0x959845D3UL, 0x1F4F1B2BUL,
    0xE0D5E91EUL, 0xFAEFE88AUL, 0x0D9785D6UL, 0x6FBDE064UL, 0x4AB018A1UL, 0xA19B2366UL, 0xA4705F4EUL, 0x91C01CC8UL,
    0x97D2D988UL, 0xE3F4D9CBUL, 0x0C55EFE1UL, 0xD7018701UL, 0x77D03111UL, 0x6AC7F0C3UL, 0x020754FAUL, 0x5D6A1C56UL,
    0x09B64C2BUL, 0xACB54F0CUL, 0x091AF964UL, 0x4AD6BFB8UL, 0xC5F0ED01UL, 0x77C2C07BUL, 0xC7A06A74UL, 0x57AF154FUL,
    0x7EB17CBDUL, 0xB5AE7E4DUL, 0x08D89353UL, 0xF26AD8DDUL, 0xF890C4B1UL, 0xBC9E13DEUL, 0x61D761C0UL, 0x9B0515D1UL,
    0xE7B82D07UL, 0x9E832D8EUL, 0x0A9E2D0AUL, 0xE0DF7733UL, 0xBF30BE61UL, 0x3A0A6170UL, 0x503F7B5DUL, 0x158A1232UL,
    0x90BF1D91UL, 0x87981CCFUL, 0x0B5C473DUL, 0x58631056UL, 0x825097D1UL, 0xF156B2D5UL, 0xF64870E9UL, 0xD92012ACUL,
    0x1DB71064UL, 0x4AC21251UL, 0x1C26A370UL, 0x5019579FUL, 0x60E09782UL, 0x03D6029BUL, 0x67DE9CCEUL, 0x7CBB312BUL,
    0x6AB020F2UL, 0x53D92310UL, 0x1DE4C947UL, 0xE8A530FAUL, 0x5D80BE32UL, 0xC88AD13EUL, 0xC1A9977AUL, 0xB01131B5UL,
    0xF3B97148UL, 0x78F470D3UL, 0x1FA2771EUL, 0xFA109F14UL, 0x1A20C4E2UL, 0x4E1EA390UL, 0xF0418DE7UL, 0x3E9E3656UL,
    0x84BE41DEUL, 0x61EF4192UL, 0x1E601D29UL, 0x42ACF871UL, 0x2740ED52UL, 0x85427035UL, 0x56368653UL, 0xF23436C8UL,
    0x1ADAD47DUL, 0x2EAED755UL, 0x1B2F0BACUL, 0xDF7BC0C8UL, 0x95603142UL, 0x9847408DUL, 0x9391B8DDUL, 0xF8F13FD1UL,
    0x6DDDE4EBUL, 0x37B5E614UL, 0x1AED619BUL, 0x67C7A7ADUL, 0xA80018F2UL, 0x531B9328UL, 0x35E6B369UL, 0x345B3F4FUL,
    0xF4D4B551UL, 0x1C98B5D7UL, 0x18ABDFC2UL, 0x75720843UL, 0xEFA06222UL, 0xD58FE186UL, 0x040EA9F4UL, 0xBAD438ACUL,
    0x83D385C7UL, 0x05838496UL, 0x1969B5F5UL, 0xCDCE6F26UL, 0xD2C04B92UL, 0x1ED33223UL, 0xA279A240UL, 0x767E3832UL,
    0x136C9856UL, 0x821B9859UL, 0x1235F2C8UL, 0x95AD7F70UL, 0x5090DC43UL, 0xEF8580F6UL, 0x5431D2A9UL, 0xAF5E2A9EUL,
    0x646BA8C0UL, 0x9B00A918UL, 0x13F798FFUL, 0x2D111815UL, 0x6DF0F5F3UL, 0x24D95353UL, 0xF246D91DUL, 0x63F42A00UL,
    0xFD62F97AUL, 0xB02DFADBUL, 0x11B126A6UL, 0x3FA4B7FBUL, 0x2A508F23UL, 0xA24D21FDUL, 0xC3AEC380UL, 0xED7B2DE3UL,
    0x8A65C9ECUL, 0xA936CB9AUL, 0x10734C91UL, 0x8718D09EUL, 0x1730A693UL, 0x6911F258UL, 0x65D9C834UL, 0x21D12D7DUL,
    0x14015C4FUL, 0xE6775D5DUL, 0x153C5A14UL, 0x1ACFE827UL, 0xA5107A83UL, 0x7414C2E0UL, 0xA07EF6BAUL, 0x2B142464UL,
    0x63066CD9UL, 0xFF6C6C1CUL, 0x14FE3023UL, 0xA2738F42UL, 0x98705333UL, 0xBF481145UL, 0x0609FD0EUL, 0xE7BE24FAUL,
    0xFA0F3D63UL, 0xD4413FDFUL, 0x16B88E7AUL, 0xB0C620ACUL, 0xDFD029E3UL, 0x39DC63EBUL, 0x37E1E793UL, 0x69312319UL,
    0x8D080DF5UL, 0xCD5A0E9EUL, 0x177AE44DUL, 0x087A47C9UL, 0xE2B00053UL, 0xF280B04EUL, 0x9196EC27UL, 0xA59B2387UL,
    0x3B6E20C8UL, 0x958424A2UL, 0x384D46E0UL, 0xA032AF3EUL, 0xC1C12F04UL, 0x07AC0536UL, 0xCFBD399CUL, 0xF9766256UL,
    0x4C69105EUL, 0x8C9F15E3UL, 0x398F2CD7UL, 0x188EC85BUL, 0xFCA106B4UL, 0xCCF0D693UL, 0x69CA3228UL, 0x35DC62C8UL,
    0xD56041E4UL, 0xA7B24620UL, 0x3BC9928EUL, 0x0A3B67B5UL, 0xBB017C64UL, 0x4A64A43DUL, 0x582228B5UL, 0xBB53652BUL,
    0xA2677172UL, 0xBEA97761UL, 0x3A0BF8B9UL, 0xB28700D0UL, 0x866155D4UL, 0x81387798UL, 0xFE552301UL, 0x77F965B5UL,
    0x3C03E4D1UL, 0xF1E8E1A6UL, 0x3F44EE3CUL, 0x2F503869UL, 0x344189C4UL, 0x9C3D4720UL, 0x3BF21D8FUL, 0x7D3C6CACUL,
    0x4B04D447UL, 0xE8F3D0E7UL, 0x3E86840BUL, 0x97EC5F0CUL, 0x0921A074UL, 0x57619485UL, 0x9D85163BUL, 0xB1966C32UL,
    0xD20D85FDUL, 0xC3DE8324UL, 0x3CC03A52UL, 0x8559F0E2UL, 0x4E81DAA4UL, 0xD1F5E62BUL, 0xAC6D0CA6UL, 0x3F196BD1UL,
    0xA50AB56BUL, 0xDAC5B265UL, 0x3D025065UL, 0x3DE59787UL, 0x73E1F314UL, 0x1AA9358EUL, 0x0A1A0712UL, 0xF3B36B4FUL,
    0x35B5A8FAUL, 0x5D5DAEAAUL, 0x365E1758UL, 0x658687D1UL, 0xF1B164C5UL, 0xEBFF875BUL, 0xFC5277FBUL, 0x2A9379E3UL,
    0x42B2986CUL, 0x44469FEBUL, 0x379C7D6FUL, 0xDD3AE0B4UL, 0xCCD14D75UL, 0x20A354FEUL, 0x5A257C4FUL, 0xE639797DUL,
    0xDBBBC9D6UL, 0x6F6BCC28UL, 0x35DAC336UL, 0xCF8F4F5AUL, 0x8B7137A5UL, 0xA6372650UL, 0x6BCD66D2UL, 0x68B67E9EUL,
    0xACBCF940UL, 0x7670FD69UL, 0x3418A901UL, 0x7733283FUL, 0xB6111E15UL, 0x6D6BF5F5UL, 0xCDBA6D66UL, 0xA41C7E00UL,
    0x32D86CE3UL, 0x39316BAEUL, 0x3157BF84UL, 0xEAE41086UL, 0x0431C205UL, 0x706EC54DUL, 0x081D53E8UL, 0xAED97719UL,
    0x45DF5C75UL, 0x202A5AEFUL, 0x3095D5B3UL, 0x525877E3UL, 0x3951EBB5UL, 0xBB3216E8UL, 0xAE6A585CUL, 0x62737787UL,
    0xDCD60DCFUL, 0x0B07092CUL, 0x32D36BEAUL, 0x40EDD80DUL, 0x7EF19165UL, 0x3DA66446UL, 0x9F8242C1UL, 0xECFC7064UL,
    0xABD13D59UL, 0x121C386DUL, 0x331101DDUL, 0xF851BF68UL, 0x4391B8D5UL, 0xF6FAB7E3UL, 0x39F54975UL, 0x205670FAUL,
    0x26D930ACUL, 0xDF4636F3UL, 0x246BE590UL, 0xF02BF8A1UL, 0xA121B886UL, 0x047A07ADUL, 0xA863A552UL, 0x85CD537DUL,
    0x51DE003AUL, 0xC65D07B2UL, 0x25A98FA7UL, 0x48979FC4UL, 0x9C419136UL, 0xCF26D408UL, 0x0E14AEE6UL, 0x496753E3UL,
    0xC8D75180UL, 0xED705471UL, 0x27EF31FEUL, 0x5A22302AUL, 0xDBE1EBE6UL, 0x49B2A6A6UL, 0x3FFCB47BUL, 0xC7E85400UL,
    0xBFD06116UL, 0xF46B6530UL, 0x262D5BC9UL, 0xE29E574FUL, 0xE681C256UL, 0x82EE7503UL, 0x998BBFCFUL, 0x0B42549EUL,
    0x21B4F4B5UL, 0xBB2AF3F7UL, 0x23624D4CUL, 0x7F496FF6UL, 0x54A11E46UL, 0x9FEB45BBUL, 0x5C2C8141UL, 0x01875D87UL,
    0x56B3C423UL, 0xA231C2B6UL, 0x22A0277BUL, 0xC7F50893UL, 0x69C137F6UL, 0x54B7961EUL, 0xFA5B8AF5UL, 0xCD2D5D19UL,
    0xCFBA9599UL, 0x891C9175UL, 0x20E69922UL, 0xD540A77DUL, 0x2E614D26UL, 0xD223E4B0UL, 0xCBB39068UL, 0x43A25AFAUL,
    0xB8BDA50FUL, 0x9007A034UL, 0x2124F315UL, 0x6DFCC018UL, 0x13016496UL, 0x197F3715UL, 0x6DC49BDCUL, 0x8F085A64UL,
    0x2802B89EUL, 0x179FBCFBUL, 0x2A78B428UL, 0x359FD04EUL, 0x9151F347UL, 0xE82985C0UL, 0x9B8CEB35UL, 0x562848C8UL,
    0x5F058808UL, 0x0E848DBAUL, 0x2BBADE1FUL, 0x8D23B72BUL, 0xAC31DAF7UL, 0x23755665UL, 0x3DFBE081UL, 0x9A824856UL,
    0xC60CD9B2UL, 0x25A9DE79UL, 0x29FC6046UL, 0x9F9618C5UL, 0xEB91A027UL, 0xA5E124CBUL, 0x0C13FA1CUL, 0x140D4FB5UL,
    0xB10BE924UL, 0x3CB2EF38UL, 0x283E0A71UL, 0x272A7FA0UL, 0xD6F18997UL, 0x6EBDF76EUL, 0xAA64F1A8UL, 0xD8A74F2BUL,
    0x2F6F7C87UL, 0x73F379FFUL, 0x2D711CF4UL, 0xBAFD4719UL, 0x64D15587UL, 0x73B8C7D6UL, 0x6FC3CF26UL, 0xD2624632UL,
    0x58684C11UL, 0x6AE848BEUL, 0x2CB376C3UL, 0x0241207CUL, 0x59B17C37UL, 0xB8E41473UL, 0xC9B4C492UL, 0x1EC846ACUL,
    0xC1611DABUL, 0x41C51B7DUL, 0x2EF5C89AUL, 0x10F48F92UL, 0x1E1106E7UL, 0x3E7066DDUL, 0xF85CDE0FUL, 0x9047414FUL,
    0xB6662D3DUL, 0x58DE2A3CUL, 0x2F37A2ADUL, 0xA848E8F7UL, 0x23712F57UL, 0xF52CB578UL, 0x5E2BD5BBUL, 0x5CED41D1UL,
    0x76DC4190UL, 0xF0794F05UL, 0x709A8DC0UL, 0x9B14583DUL, 0x58F35849UL, 0x0F580A6CUL, 0x440B7579UL, 0x299DC2EDUL,
    0x01DB7106UL, 0xE9627E44UL, 0x7158E7F7UL, 0x23A83F58UL, 0x659371F9UL, 0xC404D9C9UL, 0xE27C7ECDUL, 0xE537C273UL,
    0x98D220BCUL, 0xC24F2D87UL, 0x731E59AEUL, 0x311D90B6UL, 0x22330B29UL, 0x4290AB67UL, 0xD3946450UL, 0x6BB8C590UL,
    0xEFD5102AUL, 0xDB541CC6UL, 0x72DC3399UL, 0x89A1F7D3UL, 0x1F532299UL, 0x89CC78C2UL, 0x75E36FE4UL, 0xA712C50EUL,
    0x71B18589UL, 0x94158A01UL, 0x7793251CUL, 0x1476CF6AUL, 0xAD73FE89UL, 0x94C9487AUL, 0xB044516AUL, 0xADD7CC17UL,
    0x06B6B51FUL, 0x8D0EBB40UL, 0x76514F2BUL, 0xACCAA80FUL, 0x9013D739UL, 0x5F959BDFUL, 0x16335ADEUL, 0x617DCC89UL,
    0x9FBFE4A5UL, 0xA623E883UL, 0x7417F172UL, 0xBE7F07E1UL, 0xD7B3ADE9UL, 0xD901E971UL, 0x27DB4043UL, 0xEFF2CB6AUL,
    0xE8B8D433UL, 0xBF38D9C2UL, 0x75D59B45UL, 0x06C36084UL, 0xEAD38459UL, 0x125D3AD4UL, 0x81AC4BF7UL, 0x2358CBF4UL,
    0x7807C9A2UL, 0x38A0C50DUL, 0x7E89DC78UL, 0x5EA070D2UL, 0x68831388UL, 0xE30B8801UL, 0x77E43B1EUL, 0xFA78D958UL,
    0x0F00F934UL, 0x21BBF44CUL, 0x7F4BB64FUL, 0xE61C17B7UL, 0x55E33A38UL, 0x28575BA4UL, 0xD19330AAUL, 0x36D2D9C6UL,
    0x9609A88EUL, 0x0A96A78FUL, 0x7D0D0816UL, 0xF4A9B859UL, 0x124340E8UL, 0xAEC3290AUL, 0xE07B2A37UL, 0xB85DDE25UL,
    0xE10E9818UL, 0x138D96CEUL, 0x7CCF6221UL, 0x4C15DF3CUL, 0x2F236958UL, 0x659FFAAFUL, 0x460C2183UL, 0x74F7DEBBUL,
    0x7F6A0DBBUL, 0x5CCC0009UL, 0x798074A4UL, 0xD1C2E785UL, 0x9D03B548UL, 0x789ACA17UL, 0x83AB1F0DUL, 0x7E32D7A2UL,
    0x086D3D2DUL, 0x45D73148UL, 0x78421E93UL, 0x697E80E0UL, 0xA0639CF8UL, 0xB3C619B2UL, 0x25DC14B9UL, 0xB298D73CUL,
    0x91646C97UL, 0x6EFA628BUL, 0x7A04A0CAUL, 0x7BCB2F0EUL, 0xE7C3E628UL, 0x35526B1CUL, 0x14340E24UL, 0x3C17D0DFUL,
    0xE6635C01UL, 0x77E153CAUL, 0x7BC6CAFDUL, 0xC377486BUL, 0xDAA3CF98UL, 0xFE0EB8B9UL, 0xB2430590UL, 0xF0BDD041UL,
    0x6B6B51F4UL, 0xBABB5D54UL, 0x6CBC2EB0UL, 0xCB0D0FA2UL, 0x3813CFCBUL, 0x0C8E08F7UL, 0x23D5E9B7UL, 0x5526F3C6UL,
    0x1C6C6162UL, 0xA3A06C15UL, 0x6D7E4487UL, 0x73B168C7UL, 0x0573E67BUL, 0xC7D2DB52UL, 0x85A2E203UL, 0x998CF358UL,
    0x856530D8UL, 0x888D3FD6UL, 0x6F38FADEUL, 0x6104C729UL, 0x42D39CABUL, 0x4146A9FCUL, 0xB44AF89EUL, 0x1703F4BBUL,
    0xF262004EUL, 0x91960E97UL, 0x6EFA90E9UL, 0xD9B8A04CUL, 0x7FB3B51BUL, 0x8A1A7A59UL, 0x123DF32AUL, 0xDBA9F425UL,
    0x6C0695EDUL, 0xDED79850UL, 0x6BB5866CUL, 0x446F98F5UL, 0xCD93690BUL, 0x971F4AE1UL, 0xD79ACDA4UL, 0xD16CFD3CUL,
    0x1B01A57BUL, 0xC7CCA911UL, 0x6A77EC5BUL, 0xFCD3FF90UL, 0xF0F340BBUL, 0x5C439944UL, 0x71EDC610UL, 0x1DC6FDA2UL,
    0x8208F4C1UL, 0xECE1FAD2UL, 0x68315202UL, 0xEE66507EUL, 0xB7533A6BUL, 0xDAD7EBEAUL, 0x4005DC8DUL, 0x9349FA41UL,
    0xF50FC457UL, 0xF5FACB93UL, 0x69F33835UL, 0x56DA371BUL, 0x8A3313DBUL, 0x118B384FUL, 0xE672D739UL, 0x5FE3FADFUL,
    0x65B0D9C6UL, 0x7262D75CUL, 0x62AF7F08UL, 0x0EB9274DUL, 0x0863840AUL, 0xE0DD8A9AUL, 0x103AA7D0UL, 0x86C3E873UL,
    0x12B7E950UL, 0x6B79E61DUL, 0x636D153FUL, 0xB6054028UL, 0x3503ADBAUL, 0x2B81593FUL, 0xB64DAC64UL, 0x4A69E8EDUL,
    0x8BBEB8EAUL, 0x4054B5DEUL, 0x612BAB66UL, 0xA4B0EFC6UL, 0x72A3D76AUL, 0xAD152B91UL, 0x87A5B6F9UL, 0xC4E6EF0EUL,
    0xFCB9887CUL, 0x594F849FUL, 0x60E9C151UL, 0x1C0C88A3UL, 0x4FC3FEDAUL, 0x6649F834UL, 0x21D2BD4DUL, 0x084CEF90UL,
    0x62DD1DDFUL, 0x160E1258UL, 0x65A6D7D4UL, 0x81DBB01AUL, 0xFDE322CAUL, 0x7B4CC88CUL, 0xE47583C3UL, 0x0289E689UL,
    0x15DA2D49UL, 0x0F152319UL, 0x6464BDE3UL, 0x3967D77FUL, 0xC0830B7AUL, 0xB0101B29UL, 0x42028877UL, 0xCE23E617UL,
    0x8CD37CF3UL, 0x243870DAUL, 0x662203BAUL, 0x2BD27891UL, 0x872371AAUL, 0x36846987UL, 0x73EA92EAUL, 0x40ACE1F4UL,
    0xFBD44C65UL, 0x3D23419BUL, 0x67E0698DUL, 0x936E1FF4UL, 0xBA43581AUL, 0xFDD8BA22UL, 0xD59D995EUL, 0x8C06E16AUL,
    0x4DB26158UL, 0x65FD6BA7UL, 0x48D7CB20UL, 0x3B26F703UL, 0x9932774DUL, 0x08F40F5AUL, 0x8BB64CE5UL, 0xD0EBA0BBUL,
    0x3AB551CEUL, 0x7CE65AE6UL, 0x4915A117UL, 0x839A9066UL, 0xA4525EFDUL, 0xC3A8DCFFUL, 0x2DC14751UL, 0x1C41A025UL,
    0xA3BC0074UL, 0x57CB0925UL, 0x4B531F4EUL, 0x912F3F88UL, 0xE3F2242DUL, 0x453CAE51UL, 0x1C295DCCUL, 0x92CEA7C6UL,
    0xD4BB30E2UL, 0x4ED03864UL, 0x4A917579UL, 0x299358EDUL, 0xDE920D9DUL, 0x8E607DF4UL, 0xBA5E5678UL, 0x5E64A758UL,
    0x4ADFA541UL, 0x0191AEA3UL, 0x4FDE63FCUL, 0xB4446054UL, 0x6CB2D18DUL, 0x93654D4CUL, 0x7FF968F6UL, 0x54A1AE41UL,
    0x3DD895D7UL, 0x188A9FE2UL, 0x4E1C09CBUL, 0x0CF80731UL, 0x51D2F83DUL, 0x58399EE9UL, 0xD98E6342UL, 0x980BAEDFUL,
    0xA4D1C46DUL, 0x33A7CC21UL, 0x4C5AB792UL, 0x1E4DA8DFUL, 0x167282EDUL, 0xDEADEC47UL, 0xE86679DFUL, 0x1684A93CUL,
    0xD3D6F4FBUL, 0x2ABCFD60UL, 0x4D98DDA5UL, 0xA6F1CFBAUL, 0x2B12AB5DUL, 0x15F13FE2UL, 0x4E11726BUL, 0xDA2EA9A2UL,
    0x4369E96AUL, 0xAD24E1AFUL, 0x46C49A98UL, 0xFE92DFECUL, 0xA9423C8CUL, 0xE4A78D37UL, 0xB8590282UL, 0x030EBB0EUL,
    0x346ED9FCUL, 0xB43FD0EEUL, 0x4706F0AFUL, 0x462EB889UL, 0x9422153CUL, 0x2FFB5E92UL, 0x1E2E0936UL, 0xCFA4BB90UL,
    0xAD678846UL, 0x9F12832DUL, 0x45404EF6UL, 0x549B1767UL, 0xD3826FECUL, 0xA96F2C3CUL, 0x2FC613ABUL, 0x412BBC73UL,
    0xDA60B8D0UL, 0x8609B26CUL, 0x448224C1UL, 0xEC277002UL, 0xEEE2465CUL, 0x6233FF99UL, 0x89B1181FUL, 0x8D81BCEDUL,
    0x44042D73UL, 0xC94824ABUL, 0x41CD3244UL, 0x71F048BBUL, 0x5CC29A4CUL, 0x7F36CF21UL, 0x4C162691UL, 0x8744B5F4UL,
    0x33031DE5UL, 0xD05315EAUL, 0x400F5873UL, 0xC94C2FDEUL, 0x61A2B3FCUL, 0xB46A1C84UL, 0xEA612D25UL, 0x4BEEB56AUL,
    0xAA0A4C5FUL, 0xFB7E4629UL, 0x4249E62AUL, 0xDBF98030UL, 0x2602C92CUL, 0x32FE6E2AUL, 0xDB8937B8UL, 0xC561B289UL,
    0xDD0D7CC9UL, 0xE2657768UL, 0x438B8C1DUL, 0x6345E755UL, 0x1B62E09CUL, 0xF9A2BD8FUL, 0x7DFE3C0CUL, 0x09CBB217UL,
    0x5005713CUL, 0x2F3F79F6UL, 0x54F16850UL, 0x6B3FA09CUL, 0xF9D2E0CFUL, 0x0B220DC1UL, 0xEC68D02BUL, 0xAC509190UL,
    0x270241AAUL, 0x362448B7UL, 0x55330267UL, 0xD383C7F9UL, 0xC4B2C97FUL, 0xC07EDE64UL, 0x4A1FDB9FUL, 0x60FA910EUL,
    0xBE0B1010UL, 0x1D091B74UL, 0x5775BC3EUL, 0xC1366817UL, 0x8312B3AFUL, 0x46EAACCAUL, 0x7BF7C102UL, 0xEE7596EDUL,
    0xC90C2086UL, 0x04122A35UL, 0x56B7D609UL, 0x798A0F72UL, 0xBE729A1FUL, 0x8DB67F6FUL, 0xDD80CAB6UL, 0x22DF9673UL,
    0x5768B525UL, 0x4B53BCF2UL, 0x53F8C08CUL, 0xE45D37CBUL, 0x0C52460FUL, 0x90B34FD7UL, 0x1827F438UL, 0x281A9F6AUL,
    0x206F85B3UL, 0x52488DB3UL, 0x523AAABBUL, 0x5CE150AEUL, 0x31326FBFUL, 0x5BEF9C72UL, 0xBE50FF8CUL, 0xE4B09FF4UL,
    0xB966D409UL, 0x7965DE70UL, 0x507C14E2UL, 0x4E54FF40UL, 0x7692156FUL, 0xDD7BEEDCUL, 0x8FB8E511UL, 0x6A3F9817UL,
    0xCE61E49FUL, 0x607EEF31UL, 0x51BE7ED5UL, 0xF6E89825UL, 0x4BF23CDFUL, 0x16273D79UL, 0x29CFEEA5UL, 0xA6959889UL,
    0x5EDEF90EUL, 0xE7E6F3FEUL, 0x5AE239E8UL, 0xAE8B8873UL, 0xC9A2AB0EUL, 0xE7718FACUL, 0xDF879E4CUL, 0x7FB58A25UL,
    0x29D9C998UL, 0xFEFDC2BFUL, 0x5B2053DFUL, 0x1637EF16UL, 0xF4C282BEUL, 0x2C2D5C09UL, 0x79F095F8UL, 0xB31F8ABBUL,
    0xB0D09822UL, 0xD5D0917CUL, 0x5966ED86UL, 0x048240F8UL, 0xB362F86EUL, 0xAAB92EA7UL, 0x48188F65UL, 0x3D908D58UL,
    0xC7D7A8B4UL, 0xCCCBA03DUL, 0x58A487B1UL, 0xBC3E279DUL, 0x8E02D1DEUL, 0x61E5FD02UL, 0xEE6F84D1UL, 0xF13A8DC6UL,
    0x59B33D17UL, 0x838A36FAUL, 0x5DEB9134UL, 0x21E91F24UL, 0x3C220DCEUL, 0x7CE0CDBAUL, 0x2BC8BA5FUL, 0xFBFF84DFUL,
    0x2EB40D81UL, 0x9A9107BBUL, 0x5C29FB03UL, 0x99557841UL, 0x0142247EUL, 0xB7BC1E1FUL, 0x8DBFB1EBUL, 0x37558441UL,
    0xB7BD5C3BUL, 0xB1BC5478UL, 0x5E6F455AUL, 0x8BE0D7AFUL, 0x46E25EAEUL, 0x31286CB1UL, 0xBC57AB76UL, 0xB9DA83A2UL,
    0xC0BA6CADUL, 0xA8A76539UL, 0x5FAD2F6DUL, 0x335CB0CAUL, 0x7B82771EUL, 0xFA74BF14UL, 0x1A20A0C2UL, 0x7570833CUL,
    0xEDB88320UL, 0x3B83984BUL, 0xE1351B80UL, 0xED59B63BUL, 0xB1E6B092UL, 0x1EB014D8UL, 0x8816EAF2UL, 0x533B85DAUL,
    0x9ABFB3B6UL, 0x2298A90AUL, 0xE0F771B7UL, 0x55E5D15EUL, 0x8C869922UL, 0xD5ECC77DUL, 0x2E61E146UL, 0x9F918544UL,
    0x03B6E20CUL, 0x09B5FAC9UL, 0xE2B1CFEEUL, 0x47507EB0UL, 0xCB26E3F2UL, 0x5378B5D3UL, 0x1F89FBDBUL, 0x111E82A7UL,
    0x74B1D29AUL, 0x10AECB88UL, 0xE373A5D9UL, 0xFFEC19D5UL, 0xF646CA42UL, 0x98246676UL, 0xB9FEF06FUL, 0xDDB48239UL,
    0xEAD54739UL, 0x5FEF5D4FUL, 0xE63CB35CUL, 0x623B216CUL, 0x44661652UL, 0x852156CEUL, 0x7C59CEE1UL, 0xD7718B20UL,
    0x9DD277AFUL, 0x46F46C0EUL, 0xE7FED96BUL, 0xDA874609UL, 0x79063FE2UL, 0x4E7D856BUL, 0xDA2EC555UL, 0x1BDB8BBEUL,
    0x04DB2615UL, 0x6DD93FCDUL, 0xE5B86732UL, 0xC832E9E7UL, 0x3EA64532UL, 0xC8E9F7C5UL, 0xEBC6DFC8UL, 0x95548C5DUL,
    0x73DC1683UL, 0x74C20E8CUL, 0xE47A0D05UL, 0x708E8E82UL, 0x03C66C82UL, 0x03B52460UL, 0x4DB1D47CUL, 0x59FE8CC3UL,
    0xE3630B12UL, 0xF35A1243UL, 0xEF264A38UL, 0x28ED9ED4UL, 0x8196FB53UL, 0xF2E396B5UL, 0xBBF9A495UL, 0x80DE9E6FUL,
    0x94643B84UL, 0xEA412302UL, 0xEEE4200FUL, 0x9051F9B1UL, 0xBCF6D2E3UL, 0x39BF4510UL, 0x1D8EAF21UL, 0x4C749EF1UL,
    0x0D6D6A3EUL, 0xC16C70C1UL, 0xECA29E56UL, 0x82E4565FUL, 0xFB56A833UL, 0xBF2B37BEUL, 0x2C66B5BCUL, 0xC2FB9912UL,
    0x7A6A5AA8UL, 0xD8774180UL, 0xED60F461UL, 0x3A58313AUL, 0xC6368183UL, 0x7477E41BUL, 0x8A11BE08UL, 0x0E51998CUL,
    0xE40ECF0BUL, 0x9736D747UL, 0xE82FE2E4UL, 0xA78F0983UL, 0x74165D93UL, 0x6972D4A3UL, 0x4FB68086UL, 0x04949095UL,
    0x9309FF9DUL, 0x8E2DE606UL, 0xE9ED88D3UL, 0x1F336EE6UL, 0x49767423UL, 0xA22E0706UL, 0xE9C18B32UL, 0xC83E900BUL,
    0x0A00AE27UL, 0xA500B5C5UL, 0xEBAB368AUL, 0x0D86C108UL, 0x0ED60EF3UL, 0x24BA75A8UL, 0xD82991AFUL, 0x46B197E8UL,
    0x7D079EB1UL, 0xBC1B8484UL, 0xEA695CBDUL, 0xB53AA66DUL, 0x33B62743UL, 0xEFE6A60DUL, 0x7E5E9A1BUL, 0x8A1B9776UL,
    0xF00F9344UL, 0x71418A1AUL, 0xFD13B8F0UL, 0xBD40E1A4UL, 0xD1062710UL, 0x1D661643UL, 0xEFC8763CUL, 0x2F80B4F1UL,
    0x8708A3D2UL, 0x685ABB5BUL, 0xFCD1D2C7UL, 0x05FC86C1UL, 0xEC660EA0UL, 0xD63AC5E6UL, 0x49BF7D88UL, 0xE32AB46FUL,
    0x1E01F268UL, 0x4377E898UL, 0xFE976C9EUL, 0x1749292FUL, 0xABC67470UL, 0x50AEB748UL, 0x78576715UL, 0x6DA5B38CUL,
    0x6906C2FEUL, 0x5A6CD9D9UL, 0xFF5506A9UL, 0xAFF54E4AUL, 0x96A65DC0UL, 0x9BF264EDUL, 0xDE206CA1UL, 0xA10FB312UL,
    0xF762575DUL, 0x152D4F1EUL, 0xFA1A102CUL, 0x322276F3UL, 0x248681D0UL, 0x86F75455UL, 0x1B87522FUL, 0xABCABA0BUL,
    0x806567CBUL, 0x0C367E5FUL, 0xFBD87A1BUL, 0x8A9E1196UL, 0x19E6A860UL, 0x4DAB87F0UL, 0xBDF0599BUL, 0x6760BA95UL,
    0x196C3671UL, 0x271B2D9CUL, 0xF99EC442UL, 0x982BBE78UL, 0x5E46D2B0UL, 0xCB3FF55EUL, 0x8C184306UL, 0xE9EFBD76UL,
    0x6E6B06E7UL, 0x3E001CDDUL, 0xF85CAE75UL, 0x2097D91DUL, 0x6326FB00UL, 0x006326FBUL, 0x2A6F48B2UL, 0x2545BDE8UL,
    0xFED41B76UL, 0xB9980012UL, 0xF300E948UL, 0x78F4C94BUL, 0xE1766CD1UL, 0xF135942EUL, 0xDC27385BUL, 0xFC65AF44UL,
    0x89D32BE0UL, 0xA0833153UL, 0xF2C2837FUL, 0xC048AE2EUL, 0xDC164561UL, 0x3A69478BUL, 0x7A5033EFUL, 0x30CFAFDAUL,
    0x10DA7A5AUL, 0x8BAE6290UL, 0xF0843D26UL, 0xD2FD01C0UL, 0x9BB63FB1UL, 0xBCFD3525UL, 0x4BB82972UL, 0xBE40A839UL,
    0x67DD4ACCUL, 0x92B553D1UL, 0xF1465711UL, 0x6A4166A5UL, 0xA6D61601UL, 0x77A1E680UL, 0xEDCF22C6UL, 0x72EAA8A7UL,
    0xF9B9DF6FUL, 0xDDF4C516UL, 0xF4094194UL, 0xF7965E1CUL, 0x14F6CA11UL, 0x6AA4D638UL, 0x28681C48UL, 0x782FA1BEUL,
    0x8EBEEFF9UL, 0xC4EFF457UL, 0xF5CB2BA3UL, 0x4F2A3979UL, 0x2996E3A1UL, 0xA1F8059DUL, 0x8E1F17FCUL, 0xB485A120UL,
    0x17B7BE43UL, 0xEFC2A794UL, 0xF78D95FAUL, 0x5D9F9697UL, 0x6E369971UL, 0x276C7733UL, 0xBFF70D61UL, 0x3A0AA6C3UL,
    0x60B08ED5UL, 0xF6D996D5UL, 0xF64FFFCDUL, 0xE523F1F2UL, 0x5356B0C1UL, 0xEC30A496UL, 0x198006D5UL, 0xF6A0A65DUL,
    0xD6D6A3E8UL, 0xAE07BCE9UL, 0xD9785D60UL, 0x4D6B1905UL, 0x70279F96UL, 0x191C11EEUL, 0x47ABD36EUL, 0xAA4DE78CUL,
    0xA1D1937EUL, 0xB71C8DA8UL, 0xD8BA3757UL, 0xF5D77E60UL, 0x4D47B626UL, 0xD240C24BUL, 0xE1DCD8DAUL, 0x66E7E712UL,
    0x38D8C2C4UL, 0x9C31DE6BUL, 0xDAFC890EUL, 0xE762D18EUL, 0x0AE7CCF6UL, 0x54D4B0E5UL, 0xD034C247UL, 0xE868E0F1UL,
    0x4FDFF252UL, 0x852AEF2AUL, 0xDB3EE339UL, 0x5FDEB6EBUL, 0x3787E546UL, 0x9F886340UL, 0x7643C9F3UL, 0x24C2E06FUL,
    0xD1BB67F1UL, 0xCA6B79EDUL, 0xDE71F5BCUL, 0xC2098E52UL, 0x85A73956UL, 0x828D53F8UL, 0xB3E4F77DUL, 0x2E07E976UL,
    0xA6BC5767UL, 0xD37048ACUL, 0xDFB39F8BUL, 0x7AB5E937UL, 0xB8C710E6UL, 0x49D1805DUL, 0x1593FCC9UL, 0xE2ADE9E8UL,
    0x3FB506DDUL, 0xF85D1B6FUL, 0xDDF521D2UL, 0x680046D9UL, 0xFF676A36UL, 0xCF45F2F3UL, 0x247BE654UL, 0x6C22EE0BUL,
    0x48B2364BUL, 0xE1462A2EUL, 0xDC374BE5UL, 0xD0BC21BCUL, 0xC2074386UL, 0x04192156UL, 0x820CEDE0UL, 0xA088EE95UL,
    0xD80D2BDAUL, 0x66DE36E1UL, 0xD76B0CD8UL, 0x88DF31EAUL, 0x4057D457UL, 0xF54F9383UL, 0x74449D09UL, 0x79A8FC39UL,
    0xAF0A1B4CUL, 0x7FC507A0UL, 0xD6A966EFUL, 0x3063568FUL, 0x7D37FDE7UL, 0x3E134026UL, 0xD23396BDUL, 0xB502FCA7UL,
    0x36034AF6UL, 0x54E85463UL, 0xD4EFD8B6UL, 0x22D6F961UL, 0x3A978737UL, 0xB8873288UL, 0xE3DB8C20UL, 0x3B8DFB44UL,
    0x41047A60UL, 0x4DF36522UL, 0xD52DB281UL, 0x9A6A9E04UL, 0x07F7AE87UL, 0x73DBE12DUL, 0x45AC8794UL, 0xF727FBDAUL,
    0xDF60EFC3UL, 0x02B2F3E5UL, 0xD062A404UL, 0x07BDA6BDUL, 0xB5D77297UL, 0x6EDED195UL, 0x800BB91AUL, 0xFDE2F2C3UL,
    0xA867DF55UL, 0x1BA9C2A4UL, 0xD1A0CE33UL, 0xBF01C1D8UL, 0x88B75B27UL, 0xA5820230UL, 0x267CB2AEUL, 0x3148F25DUL,
    0x316E8EEFUL, 0x30849167UL, 0xD3E6706AUL, 0xADB46E36UL, 0xCF1721F7UL, 0x2316709EUL, 0x1794A833UL, 0xBFC7F5BEUL,
    0x4669BE79UL, 0x299FA026UL, 0xD2241A5DUL, 0x15080953UL, 0xF2770847UL, 0xE84AA33BUL, 0xB1E3A387UL, 0x736DF520UL,
    0xCB61B38CUL, 0xE4C5AEB8UL, 0xC55EFE10UL, 0x1D724E9AUL, 0x10C70814UL, 0x1ACA1375UL, 0x20754FA0UL, 0xD6F6D6A7UL,
    0xBC66831AUL, 0xFDDE9FF9UL, 0xC49C9427UL, 0xA5CE29FFUL, 0x2DA721A4UL, 0xD196C0D0UL, 0x86024414UL, 0x1A5CD639UL,
    0x256FD2A0UL, 0xD6F3CC3AUL, 0xC6DA2A7EUL, 0xB77B8611UL, 0x6A075B74UL, 0x5702B27EUL, 0xB7EA5E89UL, 0x94D3D1DAUL,
    0x5268E236UL, 0xCFE8FD7BUL, 0xC7184049UL, 0x0FC7E174UL, 0x576772C4UL, 0x9C5E61DBUL, 0x119D553DUL, 0x5879D144UL,
    0xCC0C7795UL, 0x80A96BBCUL, 0xC25756CCUL, 0x9210D9CDUL, 0xE547AED4UL, 0x815B5163UL, 0xD43A6BB3UL, 0x52BCD85DUL,
    0xBB0B4703UL, 0x99B25AFDUL, 0xC3953CFBUL, 0x2AACBEA8UL, 0xD8278764UL, 0x4A0782C6UL, 0x724D6007UL, 0x9E16D8C3UL,
    0x220216B9UL, 0xB29F093EUL, 0xC1D382A2UL, 0x38191146UL, 0x9F87FDB4UL, 0xCC93F068UL, 0x43A57A9AUL, 0x1099DF20UL,
    0x5505262FUL, 0xAB84387FUL, 0xC011E895UL, 0x80A57623UL, 0xA2E7D404UL, 0x07CF23CDUL, 0xE5D2712EUL, 0xDC33DFBEUL,
    0xC5BA3BBEUL, 0x2C1C24B0UL, 0xCB4DAFA8UL, 0xD8C66675UL, 0x20B743D5UL, 0xF6999118UL, 0x139A01C7UL, 0x0513CD12UL,
    0xB2BD0B28UL, 0x350715F1UL, 0xCA8FC59FUL, 0x607A0110UL, 0x1DD76A65UL, 0x3DC542BDUL, 0xB5ED0A73UL, 0xC9B9CD8CUL,
    0x2BB45A92UL, 0x1E2A4632UL, 0xC8C97BC6UL, 0x72CFAEFEUL, 0x5A7710B5UL, 0xBB513013UL, 0x840510EEUL, 0x4736CA6FUL,
    0x5CB36A04UL, 0x07317773UL, 0xC90B11F1UL, 0xCA73C99BUL, 0x67173905UL, 0x700DE3B6UL, 0x22721B5AUL, 0x8B9CCAF1UL,
    0xC2D7FFA7UL, 0x4870E1B4UL, 0xCC440774UL, 0x57A4F122UL, 0xD537E515UL, 0x6D08D30EUL, 0xE7D525D4UL, 0x8159C3E8UL,
    0xB5D0CF31UL, 0x516BD0F5UL, 0xCD866D43UL, 0xEF189647UL, 0xE857CCA5UL, 0xA65400ABUL, 0x41A22E60UL, 0x4DF3C376UL,
    0x2CD99E8BUL, 0x7A468336UL, 0xCFC0D31AUL, 0xFDAD39A9UL, 0xAFF7B675UL, 0x20C07205UL, 0x704A34FDUL, 0xC37CC495UL,
    0x5BDEAE1DUL, 0x635DB277UL, 0xCE02B92DUL, 0x45115ECCUL, 0x92979FC5UL, 0xEB9CA1A0UL, 0xD63D3F49UL, 0x0FD6C40BUL,
    0x9B64C2B0UL, 0xCBFAD74EUL, 0x91AF9640UL, 0x764DEE06UL, 0xE915E8DBUL, 0x11E81EB4UL, 0xCC1D9F8BUL, 0x7AA64737UL,
    0xEC63F226UL, 0xD2E1E60FUL, 0x906DFC77UL, 0xCEF18963UL, 0xD475C16BUL, 0xDAB4CD11UL, 0x6A6A943FUL, 0xB60C47A9UL,
    0x756AA39CUL, 0xF9CCB5CCUL, 0x922B422EUL, 0xDC44268DUL, 0x93D5BBBBUL, 0x5C20BFBFUL, 0x5B828EA2UL, 0x3883404AUL,
    0x026D930AUL, 0xE0D7848DUL, 0x93E92819UL, 0x64F841E8UL, 0xAEB5920BUL, 0x977C6C1AUL, 0xFDF58516UL, 0xF42940D4UL,
    0x9C0906A9UL, 0xAF96124AUL, 0x96A63E9CUL, 0xF92F7951UL, 0x1C954E1BUL, 0x8A795CA2UL, 0x3852BB98UL, 0xFEEC49CDUL,
    0xEB0E363FUL, 0xB68D230BUL, 0x976454ABUL, 0x41931E34UL, 0x21F567ABUL, 0x41258F07UL, 0x9E25B02CUL, 0x32464953UL,
    0x72076785UL, 0x9DA070C8UL, 0x9522EAF2UL, 0x5326B1DAUL, 0x66551D7BUL, 0xC7B1FDA9UL, 0xAFCDAAB1UL, 0xBCC94EB0UL,
    0x05005713UL, 0x84BB4189UL, 0x94E080C5UL, 0xEB9AD6BFUL, 0x5B3534CBUL, 0x0CED2E0CUL, 0x09BAA105UL, 0x70634E2EUL,
    0x95BF4A82UL, 0x03235D46UL, 0x9FBCC7F8UL, 0xB3F9C6E9UL, 0xD965A31AUL, 0xFDBB9CD9UL, 0xFFF2D1ECUL, 0xA9435C82UL,
    0xE2B87A14UL, 0x1A386C07UL, 0x9E7EADCFUL, 0x0B45A18CUL, 0xE4058AAAUL, 0x36E74F7CUL, 0x5985DA58UL, 0x65E95C1CUL,
    0x7BB12BAEUL, 0x31153FC4UL, 0x9C381396UL, 0x19F00E62UL, 0xA3A5F07AUL, 0xB0733DD2UL, 0x686DC0C5UL, 0xEB665BFFUL,
    0x0CB61B38UL, 0x280E0E85UL, 0x9DFA79A1UL, 0xA14C6907UL, 0x9EC5D9CAUL, 0x7B2FEE77UL, 0xCE1ACB71UL, 0x27CC5B61UL,
    0x92D28E9BUL, 0x674F9842UL, 0x98B56F24UL, 0x3C9B51BEUL, 0x2CE505DAUL, 0x662ADECFUL, 0x0BBDF5FFUL, 0x2D095278UL,
    0xE5D5BE0DUL, 0x7E54A903UL, 0x99770513UL, 0x842736DBUL, 0x11852C6AUL, 0xAD760D6AUL, 0xADCAFE4BUL, 0xE1A352E6UL,
    0x7CDCEFB7UL, 0x5579FAC0UL, 0x9B31BB4AUL, 0x96929935UL, 0x562556BAUL, 0x2BE27FC4UL, 0x9C22E4D6UL, 0x6F2C5505UL,
    0x0BDBDF21UL, 0x4C62CB81UL, 0x9AF3D17DUL, 0x2E2EFE50UL, 0x6B457F0AUL, 0xE0BEAC61UL, 0x3A55EF62UL, 0xA386559BUL,
    0x86D3D2D4UL, 0x8138C51FUL, 0x8D893530UL, 0x2654B999UL, 0x89F57F59UL, 0x123E1C2FUL, 0xABC30345UL, 0x061D761CUL,
    0xF1D4E242UL, 0x9823F45EUL, 0x8C4B5F07UL, 0x9EE8DEFCUL, 0xB49556E9UL, 0xD962CF8AUL, 0x0DB408F1UL, 0xCAB77682UL,
    0x68DDB3F8UL, 0xB30EA79DUL, 0x8E0DE15EUL, 0x8C5D7112UL, 0xF3352C39UL, 0x5FF6BD24UL, 0x3C5C126CUL, 0x44387161UL,
    0x1FDA836EUL, 0xAA1596DCUL, 0x8FCF8B69UL, 0x34E11677UL, 0xCE550589UL, 0x94AA6E81UL, 0x9A2B19D8UL, 0x889271FFUL,
    0x81BE16CDUL, 0xE554001BUL, 0x8A809DECUL, 0xA9362ECEUL, 0x7C75D999UL, 0x89AF5E39UL, 0x5F8C2756UL, 0x825778E6UL,
    0xF6B9265BUL, 0xFC4F315AUL, 0x8B42F7DBUL, 0x118A49ABUL, 0x4115F029UL, 0x42F38D9CUL, 0xF9FB2CE2UL, 0x4EFD7878UL,
    0x6FB077E1UL, 0xD7626299UL, 0x89044982UL, 0x033FE645UL, 0x06B58AF9UL, 0xC467FF32UL, 0xC813367FUL, 0xC0727F9BUL,
    0x18B74777UL, 0xCE7953D8UL, 0x88C623B5UL, 0xBB838120UL, 0x3BD5A349UL, 0x0F3B2C97UL, 0x6E643DCBUL, 0x0CD87F05UL,
    0x88085AE6UL, 0x49E14F17UL, 0x839A6488UL, 0xE3E09176UL, 0xB9853498UL, 0xFE6D9E42UL, 0x982C4D22UL, 0xD5F86DA9UL,
    0xFF0F6A70UL, 0x50FA7E56UL, 0x82580EBFUL, 0x5B5CF613UL, 0x84E51D28UL, 0x35314DE7UL, 0x3E5B4696UL, 0x19526D37UL,
    0x66063BCAUL, 0x7BD72D95UL, 0x801EB0E6UL, 0x49E959FDUL, 0xC34567F8UL, 0xB3A53F49UL, 0x0FB35C0BUL, 0x97DD6AD4UL,
    0x11010B5CUL, 0x62CC1CD4UL, 0x81DCDAD1UL, 0xF1553E98UL, 0xFE254E48UL, 0x78F9ECECUL, 0xA9C457BFUL, 0x5B776A4AUL,
    0x8F659EFFUL, 0x2D8D8A13UL, 0x8493CC54UL, 0x6C820621UL, 0x4C059258UL, 0x65FCDC54UL, 0x6C636931UL, 0x51B26353UL,
    0xF862AE69UL, 0x3496BB52UL, 0x8551A663UL, 0xD43E6144UL, 0x7165BBE8UL, 0xAEA00FF1UL, 0xCA146285UL, 0x9D1863CDUL,
    0x616BFFD3UL, 0x1FBBE891UL, 0x8717183AUL, 0xC68BCEAAUL, 0x36C5C138UL, 0x28347D5FUL, 0xFBFC7818UL, 0x1397642EUL,
    0x166CCF45UL, 0x06A0D9D0UL, 0x86D5720DUL, 0x7E37A9CFUL, 0x0BA5E888UL, 0xE368AEFAUL, 0x5D8B73ACUL, 0xDF3D64B0UL,
    0xA00AE278UL, 0x5E7EF3ECUL, 0xA9E2D0A0UL, 0xD67F4138UL, 0x28D4C7DFUL, 0x16441B82UL, 0x03A0A617UL, 0x83D02561UL,
    0xD70DD2EEUL, 0x4765C2ADUL, 0xA820BA97UL, 0x6EC3265DUL, 0x15B4EE6FUL, 0xDD18C827UL, 0xA5D7ADA3UL, 0x4F7A25FFUL,
    0x4E048354UL, 0x6C48916EUL, 0xAA6604CEUL, 0x7C7689B3UL, 0x521494BFUL, 0x5B8CBA89UL, 0x943FB73EUL, 0xC1F5221CUL,
    0x3903B3C2UL, 0x7553A02FUL, 0xABA46EF9UL, 0xC4CAEED6UL, 0x6F74BD0FUL, 0x90D0692CUL, 0x3248BC8AUL, 0x0D5F2282UL,
    0xA7672661UL, 0x3A1236E8UL, 0xAEEB787CUL, 0x591DD66FUL, 0xDD54611FUL, 0x8DD55994UL, 0xF7EF8204UL, 0x079A2B9BUL,
    0xD06016F7UL, 0x230907A9UL, 0xAF29124BUL, 0xE1A1B10AUL, 0xE03448AFUL, 0x46898A31UL, 0x519889B0UL, 0xCB302B05UL,
    0x4969474DUL, 0x0824546AUL, 0xAD6FAC12UL, 0xF3141EE4UL, 0xA794327FUL, 0xC01DF89FUL, 0x6070932DUL, 0x45BF2CE6UL,
    0x3E6E77DBUL, 0x113F652BUL, 0xACADC625UL, 0x4BA87981UL, 0x9AF41BCFUL, 0x0B412B3AUL, 0xC6079899UL, 0x89152C78UL,
    0xAED16A4AUL, 0x96A779E4UL, 0xA7F18118UL, 0x13CB69D7UL, 0x18A48C1EUL, 0xFA1799EFUL, 0x304FE870UL, 0x50353ED4UL,
    0xD9D65ADCUL, 0x8FBC48A5UL, 0xA633EB2FUL, 0xAB770EB2UL, 0x25C4A5AEUL, 0x314B4A4AUL, 0x9638E3C4UL, 0x9C9F3E4AUL,
    0x40DF0B66UL, 0xA4911B66UL, 0xA4755576UL, 0xB9C2A15CUL, 0x6264DF7EUL, 0xB7DF38E4UL, 0xA7D0F959UL, 0x121039A9UL,
    0x37D83BF0UL, 0xBD8A2A27UL, 0xA5B73F41UL, 0x017EC639UL, 0x5F04F6CEUL, 0x7C83EB41UL, 0x01A7F2EDUL, 0xDEBA3937UL,
    0xA9BCAE53UL, 0xF2CBBCE0UL, 0xA0F829C4UL, 0x9CA9FE80UL, 0xED242ADEUL, 0x6186DBF9UL, 0xC400CC63UL, 0xD47F302EUL,
    0xDEBB9EC5UL, 0xEBD08DA1UL, 0xA13A43F3UL, 0x241599E5UL, 0xD044036EUL, 0xAADA085CUL, 0x6277C7D7UL, 0x18D530B0UL,
    0x47B2CF7FUL, 0xC0FDDE62UL, 0xA37CFDAAUL, 0x36A0360BUL, 0x97E479BEUL, 0x2C4E7AF2UL, 0x539FDD4AUL, 0x965A3753UL,
    0x30B5FFE9UL, 0xD9E6EF23UL, 0xA2BE979DUL, 0x8E1C516EUL, 0xAA84500EUL, 0xE712A957UL, 0xF5E8D6FEUL, 0x5AF037CDUL,
    0xBDBDF21CUL, 0x14BCE1BDUL, 0xB5C473D0UL, 0x866616A7UL, 0x4834505DUL, 0x15921919UL, 0x647E3AD9UL, 0xFF6B144AUL,
    0xCABAC28AUL, 0x0DA7D0FCUL, 0xB40619E7UL, 0x3EDA71C2UL, 0x755479EDUL, 0xDECECABCUL, 0xC209316DUL, 0x33C114D4UL,
    0x53B39330UL, 0x268A833FUL, 0xB640A7BEUL, 0x2C6FDE2CUL, 0x32F4033DUL, 0x585AB812UL, 0xF3E12BF0UL, 0xBD4E1337UL,
    0x24B4A3A6UL, 0x3F91B27EUL, 0xB782CD89UL, 0x94D3B949UL, 0x0F942A8DUL, 0x93066BB7UL, 0x55962044UL, 0x71E413A9UL,
    0xBAD03605UL, 0x70D024B9UL, 0xB2CDDB0CUL, 0x090481F0UL, 0xBDB4F69DUL, 0x8E035B0FUL, 0x90311ECAUL, 0x7B211AB0UL,
    0xCDD70693UL, 0x69CB15F8UL, 0xB30FB13BUL, 0xB1B8E695UL, 0x80D4DF2DUL, 0x455F88AAUL, 0x3646157EUL, 0xB78B1A2EUL,
    0x54DE5729UL, 0x42E6463BUL, 0xB1490F62UL, 0xA30D497BUL, 0xC774A5FDUL, 0xC3CBFA04UL, 0x07AE0FE3UL, 0x39041DCDUL,
    0x23D967BFUL, 0x5BFD777AUL, 0xB08B6555UL, 0x1BB12E1EUL, 0xFA148C4DUL, 0x089729A1UL, 0xA1D90457UL, 0xF5AE1D53UL,
    0xB3667A2EUL, 0xDC656BB5UL, 0xBBD72268UL, 0x43D23E48UL, 0x78441B9CUL, 0xF9C19B74UL, 0x579174BEUL, 0x2C8E0FFFUL,
    0xC4614AB8UL, 0xC57E5AF4UL, 0xBA15485FUL, 0xFB6E592DUL, 0x4524322CUL, 0x329D48D1UL, 0xF1E67F0AUL, 0xE0240F61UL,
    0x5D681B02UL, 0xEE530937UL, 0xB853F606UL, 0xE9DBF6C3UL, 0x028448FCUL, 0xB4093A7FUL, 0xC00E6597UL, 0x6EAB0882UL,
    0x2A6F2B94UL, 0xF7483876UL, 0xB9919C31UL, 0x516791A6UL, 0x3FE4614CUL, 0x7F55E9DAUL, 0x66796E23UL, 0xA201081CUL,
    0xB40BBE37UL, 0xB809AEB1UL, 0xBCDE8AB4UL, 0xCCB0A91FUL, 0x8DC4BD5CUL, 0x6250D962UL, 0xA3DE50ADUL, 0xA8C40105UL,
    0xC30C8EA1UL, 0xA1129FF0UL, 0xBD1CE083UL, 0x740CCE7AUL, 0xB0A494ECUL, 0xA90C0AC7UL, 0x05A95B19UL, 0x646E019BUL,
    0x5A05DF1BUL, 0x8A3FCC33UL, 0xBF5A5EDAUL, 0x66B96194UL, 0xF704EE3CUL, 0x2F987869UL, 0x34414184UL, 0xEAE10678UL,
    0x2D02EF8DUL, 0x9324FD72UL, 0xBE9834EDUL, 0xDE0506F1UL, 0xCA64C78CUL, 0xE4C4ABCCUL, 0x92364A30UL, 0x264B06E6UL,
};


/** @brief Determine whether a pointer is aligned.

    A pointer is aligned if its address is an even multiple of
    ::REDCONF_ALIGNMENT_SIZE.

    This is used in the below RedCrc32Update() function, which needs to know
    whether a pointer is aligned, since the slice-by-8 algorithm needs to access
    the memory in an aligned fashion, and if the pointer is not aligned, this
    can result in faults or suboptimal performance (depending on platform).

    There is no way to perform this check without deviating from MISRA C rules
    against casting pointers to integer types.  Usage of this macro violates
    MISRA-C:2012 Rule 11.4 (advisory).  The main rationale the rule cites
    against converting pointers to integers is that the chosen integer type may
    not be able to represent the pointer; this is a non-issue here since we use
    uintptr_t.  The text says the rule still applies when using uintptr_t due to
    concern about unaligned pointers, but that is not an issue here since the
    integer value of the pointer is not saved and not converted back into a
    pointer and dereferenced.  The result of casting a pointer to a sufficiently
    large integer is implementation-defined, but macros similar to this one have
    been used by Datalight for a long time in a wide variety of environments and
    they have always worked as expected.

    As Rule 11.4 is advisory, a deviation record is not required.  This notice
    and the PC-Lint error inhibition option are the only records of the
    deviation.

    @note PC-Lint also thinks this macro as it is used below violates Rule 11.6
          (required).  This is a false positive, since Rule 11.6 only applies to
          void pointers.  Below, we use it on a pointer-to-object (uint8_t *),
          which is covered by Rule 11.4.

    @note It should have been possible to use a static function instead of a
          function-like macro, but PC-Lint complained that the resulting
          function had side effects even when explicitly told it was "pure".
*/
#define IS_ALIGNED_PTR(ptr) (((uintptr_t)(ptr) & (REDCONF_ALIGNMENT_SIZE - 1U)) == 0U)


/** @brief Compute a CRC32 for the given data buffer.

    For CCITT-32 compliance, the initial CRC must be set to 0.  To CRC multiple
    buffers, call this function with the previously returned CRC value.

    @param ulInitCrc32  Starting CRC value.
    @param pBuffer      Data buffer to calculate the CRC from.
    @param ulLength     Number of bytes of data in the given buffer.

    @return The updated CRC value.
*/
uint32_t RedCrc32Update(
    uint32_t        ulInitCrc32,
    const void     *pBuffer,
    uint32_t        ulLength)
{
    uint32_t        ulCrc32;

    if(pBuffer == NULL)
    {
        REDERROR();
        ulCrc32 = SUSPICIOUS_CRC_VALUE;
    }
    else
    {
        const uint8_t  *pbBuffer = CAST_VOID_PTR_TO_CONST_UINT8_PTR(pBuffer);
        uint32_t        ulIdx = 0U;
        uint32_t        ulLen = ulLength;
        const uint32_t *pulXorCrc0 = &gaulCrc32Table[7U];
        const uint32_t *pulXorCrc1 = &gaulCrc32Table[6U];
        const uint32_t *pulXorCrc2 = &gaulCrc32Table[5U];
        const uint32_t *pulXorCrc3 = &gaulCrc32Table[4U];
        const uint32_t *pulXorData4 = &gaulCrc32Table[3U];
        const uint32_t *pulXorData5 = &gaulCrc32Table[2U];
        const uint32_t *pulXorData6 = &gaulCrc32Table[1U];
        const uint32_t *pulXorData7 = &gaulCrc32Table[0U];
        uint32_t        ulSliceLen;

        ulCrc32 = ~ulInitCrc32;

        /*  Aligned memory access is used below.  To avoid suboptimal
            performance and faults (depending on platform), handle the
            unaligned initial bytes (if any) using the Sarwate algorithm.
        */
        while((ulLen > 0U) && !IS_ALIGNED_PTR(&pbBuffer[ulIdx]))
        {
            ulCrc32 = (ulCrc32 >> 8U) ^ gaulCrc32Table[((ulCrc32 ^ pbBuffer[ulIdx]) & 0xFFU) << 3U];

            ulIdx++;
            ulLen--;
        }

        /*  Round down the length to the nearest multiple of eight.
        */
        ulSliceLen = (ulLen >> 3U) << 3U;

        /*  Compute the CRC in eight byte "slices".  Takes advantage of
            modern processors which can load in parallel from multiple
            memory locations.
        */
        while(ulIdx < ulSliceLen)
        {
          #if REDCONF_ENDIAN_BIG == 1
            ulCrc32 ^= pbBuffer[ulIdx] | ((uint32_t)pbBuffer[ulIdx+1U] << 8U) |
                       ((uint32_t)pbBuffer[ulIdx+2U] << 16U) | ((uint32_t)pbBuffer[ulIdx+3U] << 24U);
          #else
            ulCrc32 ^= *CAST_CONST_UINT32_PTR(&pbBuffer[ulIdx]);
          #endif

            ulCrc32 =
                pulXorCrc3[((ulCrc32 >> 24U) & 0xFFU) << 3U] ^
                pulXorCrc2[((ulCrc32 >> 16U) & 0xFFU) << 3U] ^
                pulXorCrc1[((ulCrc32 >> 8U)  & 0xFFU) << 3U] ^
                pulXorCrc0[ (ulCrc32         & 0xFFU) << 3U] ^
                pulXorData7[pbBuffer[ulIdx+7U] << 3U] ^
                pulXorData6[pbBuffer[ulIdx+6U] << 3U] ^
                pulXorData5[pbBuffer[ulIdx+5U] << 3U] ^
                pulXorData4[pbBuffer[ulIdx+4U] << 3U];

            ulIdx += 8U;
        }

        /*  Compute the remaining bytes with the Sarwate algorithm.
        */
        while(ulIdx < ulLen)
        {
            ulCrc32 = (ulCrc32 >> 8U) ^ gaulCrc32Table[((ulCrc32 ^ pbBuffer[ulIdx]) & 0xFFU) << 3U];

            ulIdx++;
        }

        ulCrc32 = ~ulCrc32;
    }

    return ulCrc32;
}

#else

#error "REDCONF_CRC_ALGORITHM must be set to CRC_BITWISE, CRC_SARWATE, or CRC_SLICEBY8"

#endif


/** @brief Compute a CRC32 for a metadata node buffer.

    @param pBuffer  The metadata node buffer for which to compute a CRC.  Must
                    be a block sized buffer.

    @return The CRC of the buffer.
*/
uint32_t RedCrcNode(
    const void *pBuffer)
{
    uint32_t    ulCrc;

    if(pBuffer == NULL)
    {
        REDERROR();
        ulCrc = SUSPICIOUS_CRC_VALUE;
    }
    else
    {
        const uint8_t *pbBuffer = CAST_VOID_PTR_TO_CONST_UINT8_PTR(pBuffer);

        /*  The first eight bytes of a metadata node contain the signature and
            the CRC.  There is little value in CRCing the signature, and the
            CRC cannot be CRC'd, so skip over that part of the buffer.
        */
        ulCrc = RedCrc32Update(0U, &pbBuffer[8U], REDCONF_BLOCK_SIZE - 8U);
    }

    return ulCrc;
}

